import { tekshop_sku } from './apis';
import { decodeHTML, splitArrayToChunks } from 'utils';

const breaklines = /\n|<br>|<br\/>|<span>|<\/span>|- |\+ |<p>|<\/p>/g;

const filterProduct = product => {
  const result = {};
  result.name = product.name;
  result.sku = product.sku;
  result.warranty = product.attributes.warranty;
  result.price = Number(product.price);
  result.finalPrice = product.final_price;
  result.key = product.sku;
  const parseDescription = rawDescription => {
    if (!rawDescription) return [];
    rawDescription = decodeHTML(rawDescription);
    rawDescription = rawDescription.replace(/- /g, '\n- ');
    const brDescriptions = rawDescription.split(breaklines);
    const trimmedDescriptions = brDescriptions.map(line => {
      let trimmed = line.trim();
      if (trimmed[0] !== '-') trimmed = '- ' + trimmed;
      return trimmed;
    });
    const filteredEmptyLines = trimmedDescriptions.filter(line => line.length > 2);
    return filteredEmptyLines;
  };
  result.descriptions = parseDescription(product.description);
  return result;
};

export const fetchProducts = async skuList => {
  const url = tekshop_sku + skuList.join(',');
  try {
    const response = await fetch(url);
    const data = await response.json();
    const products = data.data.map(product => filterProduct(product));
    return products;
  } catch (error) {
    return [];
  }
};

export const fetchProductsByChunks = async skuList => {
  const skuChunks = splitArrayToChunks(skuList, 10);
  const fetching = [];
  for (const skuChunk of skuChunks) {
    fetching.push(fetchProducts(skuChunk));
  }
  const fetchedData = await Promise.all(fetching);
  return [].concat(...fetchedData);
};

export const skus = [
  '1801272',
  '1801274',
  '1801273',
  '1702020',
  '1704791',
  '1704290',
  '1704295',
  '1703878',
  '1704263',
  '1704308',
  '1704151',
  '1704142',
  '1703936',
  '1704216',
  '1702240',
  '1703021',
  '1704444',
  '1603282',
  '1704531',
  '1704554',
  '1704610',
  '1704601',
  '1704632',
  '1704659',
  '1704693',
  '1705006',
  '1704709',
  '1704731',
  '1704736',
  '1704045',
  '1703811',
  '1703493',
  '1704337',
  '1704339',
  '1703631',
  '1704654',
  '1705009',
  '1704499',
  '1703633',
  '1704754',
  '1603327',
  '1601121',
  '1704649',
  '1500475',
  '1700973',
  '1704798',
  '1704455',
  '1702106',
  '1700166',
  '1704530',
  '1704799',
  '1704306',
  '1601935',
  '1704195',
  '1701255',
  '1603764',
  '1701604',
  '1701984',
  '1701262',
  '1700804',
  '1702606',
  '1703369',
  '1703868',
  '1704182',
  '1704786',
  '1702068',
  '1503479',
  '1503492',
  '1503502',
  '1503506',
  '1503523',
  '1503533',
  '1503547',
  '1503551',
  '1503557',
  '1503565',
  '1503594',
  '1503640',
  '1503643',
  '1600006',
  '1600036',
  '1600037',
  '1600054',
  '1600055',
  '1600059',
  '1600077',
  '1600124',
  '1600135',
  '1600144',
  '1600202',
  '1600218',
  '1600222',
  '1600225',
  '1600228',
  '1600269',
  '1600279',
  '1600283',
  '1600301',
  '1600326',
  '1600332',
  '1600339',
  '1600354',
  '1600359',
  '1600363',
  '1600389',
  '1600408',
  '1600411',
  '1600437',
  '1600462',
  '1600463',
  '1600493',
  '1600539',
  '1600555',
  '1600571',
  '1600589',
  '1600615',
  '1600619',
  '1600623',
  '1600629',
  '1600639',
  '1602476',
  '1602481',
  '1602508',
  '1602518',
  '1602532',
  '1602548',
  '1602556',
  '1602559',
  '1602588',
  '1602598',
  '1602625',
  '1602639',
  '1602645',
  '1602657',
  '1602660',
  '1602663',
  '1602666',
  '1602689',
  '1602706',
  '1602707',
  '1602716',
  '1602717',
  '1602731',
  '1602770',
  '1602781',
  '1602791',
  '1602807',
  '1602833',
  '1602841',
  '1602859',
  '1602888',
  '1602893',
  '1602925',
  '1602975',
  '1603006',
  '1603027',
  '1603034',
  '1603041',
  '1603065',
  '1603083',
  '1603098',
  '1603115',
  '1603203',
  '1603205',
  '1603235',
  '1603234',
  '1603246',
  '1601159',
  '1601165',
  '1601170',
  '1601190',
  '1601197',
  '1601199',
  '1601208',
  '1601214',
  '1601221',
  '1601232',
  '1601237',
  '1601269',
  '1601270',
  '1601272',
  '1601304',
  '1601318',
  '1601320',
  '1601347',
  '1601351',
  '1601377',
  '1601391',
  '1601412',
  '1601420',
  '1601442',
  '1601449',
  '1601466',
  '1601467',
  '1601492',
  '1601501',
  '1601567',
  '1601576',
  '1601578',
  '1601592',
  '1601593',
  '1601607',
  '1601617',
  '1601642',
  '1601663',
  '1601690',
  '1601714',
  '1601722',
  '1601754',
  '1601757',
  '1601760',
  '1601768',
  '1601769',
  '1601784',
  '1601797',
  '1601800',
  '1601817',
  '1601824',
  '1601845',
  '1601854',
  '1601863',
  '1601864',
  '1601870',
  '1603264',
  '1603267',
  '1603308',
  '1603311',
  '1603357',
  '1603364',
  '1603375',
  '1603388',
  '1603400',
  '1603403',
  '1603405',
  '1603420',
  '1603446',
  '1603460',
  '1603491',
  '1603536',
  '1603541',
  '1603568',
  '1603577',
  '1603599',
  '1603601',
  '1603625',
  '1603698',
  '1603707',
  '1603720',
  '1603741',
  '1603787',
  '1603791',
  '1603793',
  '1603799',
  '1603816',
  '1603849',
  '1603852',
  '1603865',
  '1603888',
  '1700020',
  '1700032',
  '1700068',
  '1700090',
  '1700117',
  '1700123',
  '1700127',
  '1700141',
  '1700169',
  '1700193',
  '1700203',
  '1700208',
  '1700876',
  '1700889',
  '1700893',
  '1700898',
  '1700900',
  '1700907',
  '1700922',
  '1700943',
  '1701052',
  '1701088',
  '1701111',
  '1701130',
  '1701173',
  '1701214',
  '1701215',
  '1701217',
  '1701243',
  '1701259',
  '1701271',
  '1701351',
  '1701353',
  '1701355',
  '1701368',
  '1701417',
  '1701506',
  '1701563',
  '1701571',
  '1701594',
  '1701624',
  '1701637',
  '1701656',
  '1701658',
  '1701705',
  '1701774',
  '1701775',
  '1701785',
  '1701790',
  '1701797',
  '1701799',
  '1701800',
  '1701867',
  '1701897',
  '1701924',
  '1701935',
  '1701962',
  '1601880',
  '1601883',
  '1601887',
  '1601901',
  '1601904',
  '1601923',
  '1601924',
  '1601942',
  '1601945',
  '1601947',
  '1601971',
  '1601973',
  '1601991',
  '1602005',
  '1602011',
  '1602038',
  '1602044',
  '1602050',
  '1602056',
  '1602065',
  '1602070',
  '1602081',
  '1602091',
  '1602095',
  '1602125',
  '1602138',
  '1602148',
  '1602195',
  '1602204',
  '1602219',
  '1602224',
  '1602239',
  '1602241',
  '1602248',
  '1602262',
  '1602278',
  '1602280',
  '1602292',
  '1602293',
  '1602335',
  '1602348',
  '1602350',
  '1602360',
  '1602363',
  '1602379',
  '1602384',
  '1602439',
  '1602440',
  '1602446',
  '1602451',
  '1602465',
  '1600649',
  '1600651',
  '1600669',
  '1600673',
  '1600678',
  '1600687',
  '1600684',
  '1600694',
  '1600705',
  '1600707',
  '1600729',
  '1600745',
  '1600752',
  '1600770',
  '1600786',
  '1600801',
  '1600826',
  '1600844',
  '1600849',
  '1600892',
  '1600900',
  '1600904',
  '1600908',
  '1600909',
  '1600933',
  '1600945',
  '1600950',
  '1600970',
  '1600976',
  '1600991',
  '1601005',
  '1601014',
  '1601025',
  '1601026',
  '1601094',
  '1601105',
  '1601109',
  '1601126',
  '1601140',
  '1700229',
  '1700235',
  '1700244',
  '1700236',
  '1700260',
  '1700261',
  '1700276',
  '1700279',
  '1700287',
  '1700292',
  '1700294',
  '1700298',
  '1700299',
  '1700322',
  '1700326',
  '1700346',
  '1700343',
  '1700337',
  '1700350',
  '1700369',
  '1700386',
  '1700394',
  '1700402',
  '1700412',
  '1700409',
  '1700415',
  '1700430',
  '1700437',
  '1700453',
  '1700496',
  '1700498',
  '1700512',
  '1700518',
  '1700531',
  '1700545',
  '1700548',
  '1700549',
  '1700569',
  '1700570',
  '1700571',
  '1700592',
  '1700588',
  '1700620',
  '1700624',
  '1700669',
  '1700684',
  '1700706',
  '1700738',
  '1700747',
  '1700757',
  '1700758',
  '1700779',
  '1700780',
  '1700798',
  '1700805',
  '1700807',
  '1700813',
  '1700839',
  '1700852',
  '1703663',
  '1704947',
  '1703770',
  '1703773',
  '1704093',
  '1704104',
  '1700830',
  '1502422',
  '1503580',
  '1701304',
  '1704258',
  '1601713',
  '1500109',
  '1502660',
  '1704431',
  '1704457',
  '1704056',
  '1704116',
  '1705004',
  '1501358',
  '1704279',
  '1700072',
  '1704401',
  '1704447',
  '1702329',
  '1702438',
  '1702444',
  '1702462',
  '1702495',
  '1702571',
  '1702612',
  '1702624',
  '1702677',
  '1702766',
  '1702811',
  '1702812',
  '1702832',
  '1702839',
  '1701159',
  '1701160',
  '1701199',
  '1701356',
  '1701466',
  '1701567',
  '1701671',
  '1701698',
  '1701830',
  '1701993',
  '1702026',
  '1702043',
  '1702136',
  '1702264',
  '1701469',
  '1701573',
  '1701615',
  '1701622',
  '1701848',
  '1701905',
  '1702045',
  '1702132',
  '1702232',
  '1403594',
  '1403630',
  '1403634',
  '1403640',
  '1403650',
  '1403667',
  '1403679',
  '1403702',
  '1403704',
  '1403705',
  '1403711',
  '1403717',
  '1403723',
  '1403746',
  '1403773',
  '1403771',
  '1403793',
  '1403835',
  '1403856',
  '1403872',
  '1403883',
  '1403895',
  '1403909',
  '1403923',
  '1403926',
  '1403961',
  '1403976',
  '1403977',
  '1403979',
  '1403980',
  '1404015',
  '1404034',
  '1404039',
  '1404072',
  '1404094',
  '1404107',
  '1404108',
  '1404117',
  '1404129',
  '1404139',
  '1404165',
  '1404169',
  '1404174',
  '1404195',
  '1404220',
  '1404224',
  '1404239',
  '1404251',
  '1404312',
  '1501081',
  '1501089',
  '1501096',
  '1501102',
  '1501124',
  '1501156',
  '1501157',
  '1501166',
  '1501199',
  '1501207',
  '1501218',
  '1501257',
  '1501258',
  '1501288',
  '1501328',
  '1501335',
  '1501343',
  '1501347',
  '1501383',
  '1501392',
  '1501399',
  '1501421',
  '1501430',
  '1501442',
  '1501467',
  '1501473',
  '1501512',
  '1501519',
  '1501541',
  '1501552',
  '1501556',
  '1501563',
  '1501580',
  '1501582',
  '1501593',
  '1501602',
  '1501613',
  '1501631',
  '1501647',
  '1501719',
  '1501722',
  '1501730',
  '1501747',
  '1501766',
  '1501781',
  '1500478',
  '1500482',
  '1500483',
  '1500488',
  '1500498',
  '1500499',
  '1500515',
  '1500524',
  '1500547',
  '1500550',
  '1500556',
  '1500559',
  '1500560',
  '1500565',
  '1500579',
  '1500615',
  '1500644',
  '1500655',
  '1500656',
  '1500680',
  '1500697',
  '1500709',
  '1500720',
  '1500736',
  '1500743',
  '1500749',
  '1500755',
  '1500756',
  '1500764',
  '1500775',
  '1500819',
  '1500827',
  '1500838',
  '1500846',
  '1500850',
  '1500878',
  '1500903',
  '1500926',
  '1500959',
  '1500985',
  '1500996',
  '1501010',
  '1501028',
  '1501031',
  '1501033',
  '1501036',
  '1503048',
  '1503051',
  '1503065',
  '1503067',
  '1503074',
  '1503081',
  '1503083',
  '1503093',
  '1503094',
  '1503098',
  '1503101',
  '1503104',
  '1503109',
  '1503103',
  '1503106',
  '1503113',
  '1503115',
  '1503119',
  '1503138',
  '1503140',
  '1503141',
  '1503142',
  '1503154',
  '1503158',
  '1503159',
  '1503171',
  '1503173',
  '1503195',
  '1503207',
  '1503213',
  '1503217',
  '1503225',
  '1503228',
  '1503230',
  '1503231',
  '1503236',
  '1503239',
  '1503276',
  '1503285',
  '1503297',
  '1503300',
  '1503331',
  '1503392',
  '1503389',
  '1503412',
  '1503418',
  '1503431',
  '1501796',
  '1501810',
  '1501840',
  '1501863',
  '1501879',
  '1501881',
  '1501886',
  '1501889',
  '1501897',
  '1501928',
  '1501938',
  '1501948',
  '1501950',
  '1501966',
  '1501967',
  '1501986',
  '1501996',
  '1501998',
  '1502000',
  '1502004',
  '1502020',
  '1502038',
  '1502054',
  '1502061',
  '1502066',
  '1502094',
  '1502105',
  '1502127',
  '1502139',
  '1502178',
  '1808415',
  '1808439',
  '1808453',
  '1808448',
  '1808481',
  '1808479',
  '1809009',
  '1801013',
  '1800194',
  '1800198',
  '1800233',
  '1800257',
  '1800336',
  '1809046',
  '1809122',
  '1809138',
  '1809137',
  '1809129',
  '1800109',
  '1800112',
  '1800135',
  '1800155',
  '1800161',
  '1800165',
  '1800168',
  '1800181',
  '1800183',
  '1800221',
  '1800260',
  '1800362',
  '1800399',
  '1800450',
  '1800454',
  '1800472',
  '1800478',
  '1800495',
  '1800503',
  '1800520',
  '1800536',
  '1800539',
  '1800571',
  '1800575',
  '1800626',
  '1800638',
  '1800696',
  '1800723',
  '1800728',
  '1800736',
  '1800743',
  '1800770',
  '1800782',
  '1800803',
  '1703539',
  '1703594',
  '1703618',
  '1703536',
  '1703546',
  '1800807',
  '1800816',
  '1800828',
  '1800847',
  '1800850',
  '1800860',
  '1800878',
  '1701990',
  '1702057',
  '1702084',
  '1702100',
  '1702139',
  '1702161',
  '1702163',
  '1702181',
  '1702187',
  '1702238',
  '1702260',
  '1702285',
  '1702461',
  '1702512',
  '1702514',
  '1702515',
  '1702534',
  '1702537',
  '1702642',
  '1702686',
  '1702693',
  '1702726',
  '1702728',
  '1702742',
  '1702749',
  '1702976',
  '1703014',
  '1703080',
  '1703090',
  '1703136',
  '1703173',
  '1703214',
  '1703243',
  '1703339',
  '1703362',
  '1703404',
  '1703561',
  '1703721',
  '1703764',
  '1704846',
  '1704858',
  '1704921',
  '1705107',
  '1705119',
  '1705131',
  '1800018',
  '1805178',
  '1805180',
  '1805184',
  '1805185',
  '1805304',
  '1805313',
  '1805349',
  '1805355',
  '1805356',
  '1805379',
  '1800350',
  '1800919',
  '1800937',
  '1800961',
  '1800976',
  '1801004',
  '1801052',
  '1801059',
  '1805024',
  '1805038',
  '1805059',
  '1805081',
  '1805082',
  '1805104',
  '1805107',
  '1805141',
  '1805160',
  '1502734',
  '1502736',
  '1502747',
  '1502827',
  '1502835',
  '1502837',
  '1502849',
  '1502862',
  '1502876',
  '1502888',
  '1502908',
  '1502913',
  '1502909',
  '1502931',
  '1502930',
  '1502937',
  '1502936',
  '1502939',
  '1502943',
  '1502973',
  '1502978',
  '1502989',
  '1502992',
  '1502991',
  '1503013',
  '1503015',
  '1503025',
  '1503028',
  '1502428',
  '1502455',
  '1502477',
  '1502502',
  '1502516',
  '1502547',
  '1502571',
  '1502580',
  '1502592',
  '1502605',
  '1502622',
  '1502620',
  '1502629',
  '1502639',
  '1502640',
  '1502661',
  '1502662',
  '1502671',
  '1502684',
  '1502717',
  '1502182',
  '1502193',
  '1502201',
  '1502235',
  '1502243',
  '1502275',
  '1502278',
  '1502297',
  '1502300',
  '1502314',
  '1502315',
  '1502323',
  '1502334',
  '1502343',
  '1502349',
  '1502381',
  '1502389',
  '1502392',
  '1703410',
  '1705121',
  '1703753',
  '1703747',
  '1703288',
  '1703473'
];
